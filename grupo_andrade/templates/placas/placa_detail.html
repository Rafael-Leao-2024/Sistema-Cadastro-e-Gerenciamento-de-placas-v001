{% extends "layout.html" %}
{% block title %}Detalhes da Placa{% endblock %}

{% block content %}
<div class="animate-fadeIn">
  <!-- Header -->
  <div class="flex justify-between items-center mb-8">
    <div class="flex items-center space-x-4">
      <div class="w-12 h-12 rounded-xl bg-gradient-to-r from-cyan-500 to-blue-500 flex items-center justify-center shadow-lg shadow-cyan-500/25">
        <i class="fas fa-car text-white text-lg"></i>
      </div>
      <div>
        <h2 class="text-3xl font-bold bg-gradient-to-r from-cyan-400 to-blue-400 bg-clip-text text-transparent">
          Detalhes da Solicitação
        </h2>
        <p class="text-cyan-300/70 text-sm mt-1">Placa: {{ placa.placa }}</p>
      </div>
    </div>
    <div class="flex space-x-3">
      <a href="{{ url_for('placas.minhas_placas') }}" class="futuristic-nav-btn group">
        <i class="fas fa-arrow-left mr-2 group-hover:-translate-x-1 transition-transform duration-200"></i>
        Voltar
      </a>
      <a
        href="{{ url_for('placas.editar_placa', placa_id=placa.id) }}"
        class="futuristic-btn group"
      >
        <i class="fas fa-edit mr-3 group-hover:scale-110 transition-transform duration-200"></i>
        Editar
      </a>
    </div>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
    <!-- Informações da Placa -->
    <div class="lg:col-span-2">
      <div class="glass-effect-advanced rounded-xl border border-cyan-500/20 overflow-hidden">
        <div class="bg-gradient-to-r from-cyan-900/30 to-blue-900/30 border-b border-cyan-500/20 px-6 py-4">
          <h3 class="text-xl font-semibold text-cyan-100 flex items-center">
            <i class="fas fa-info-circle mr-3"></i>
            Informações da Placa
          </h3>
        </div>
        <div class="p-6">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- Coluna 1 -->
            <div class="space-y-6">
              <div class="futuristic-info-card">
                <div class="text-cyan-300 text-sm font-medium mb-1">Placa</div>
                <div class="font-mono text-xl text-cyan-100 bg-cyan-500/10 px-4 py-3 rounded-lg border border-cyan-500/20">
                  {{ placa.placa }}
                </div>
              </div>

              <div class="futuristic-info-card">
                <div class="text-cyan-300 text-sm font-medium mb-1">Renavan</div>
                <div class="font-mono text-lg text-cyan-100">{{ placa.renavan }}</div>
              </div>

              <div class="futuristic-info-card">
                <div class="text-cyan-300 text-sm font-medium mb-1">Identificador</div>
                <div class="font-mono text-lg text-cyan-100">#{{ placa.id }}</div>
              </div>

              {% if placa.chassi %}
              <div class="futuristic-info-card">
                <div class="text-cyan-300 text-sm font-medium mb-1">Chassi</div>
                <div class="font-mono text-lg text-cyan-100 bg-cyan-500/10 px-4 py-3 rounded-lg border border-cyan-500/20">
                  {{ placa.chassi.upper() }}
                </div>
              </div>
              {% else %}
              <div class="futuristic-info-card">
                <div class="text-cyan-300 text-sm font-medium mb-1">Chassi</div>
                <div class="font-mono text-lg text-cyan-400/60 italic">N/A</div>
              </div>
              {% endif %}
            </div>

            <!-- Coluna 2 -->
            <div class="space-y-6">
              <div class="futuristic-info-card">
                <div class="text-cyan-300 text-sm font-medium mb-1">Solicitante</div>
                <div class="flex items-center space-x-3">
                  <div class="w-8 h-8 rounded-full bg-gradient-to-r from-cyan-500 to-blue-500 flex items-center justify-center">
                    <i class="fas fa-user text-white text-xs"></i>
                  </div>
                  <span class="text-cyan-100 text-lg">{{ usuario_solicitante.username.capitalize() }}</span>
                </div>
              </div>

              {% if placa.received %}
              <div class="futuristic-info-card">
                <div class="text-cyan-300 text-sm font-medium mb-1">Recebido por</div>
                <div class="flex items-center space-x-3">
                  <div class="w-8 h-8 rounded-full bg-gradient-to-r from-green-500 to-emerald-500 flex items-center justify-center">
                    <i class="fas fa-check text-white text-xs"></i>
                  </div>
                  <span class="text-cyan-100 text-lg">
                    {{ usuario.username if usuario else "Usuário não encontrado" }}
                  </span>
                </div>
              </div>
              {% endif %}

              <div class="futuristic-info-card">
                <div class="text-cyan-300 text-sm font-medium mb-1">CRLV</div>
                <div class="font-mono text-lg text-cyan-100">{{ placa.crlv }}</div>
              </div>

              <div class="futuristic-info-card">
                <div class="text-cyan-300 text-sm font-medium mb-1">Data de Criação</div>
                <div class="text-cyan-100 text-lg">
                  {{ placa.date_create.strftime('%d/%m/%Y %H:%M') }}
                </div>
              </div>
            </div>
          </div>

          <!-- Endereço -->
          <div class="mt-6 futuristic-info-card">
            <div class="text-cyan-300 text-sm font-medium mb-2 flex items-center">
              <i class="fas fa-map-marker-alt mr-2"></i>
              Endereço para Entrega
            </div>
            <div class="text-cyan-100 text-lg bg-cyan-500/5 px-4 py-3 rounded-lg border border-cyan-500/10">
              {{ placa.endereco_placa }}
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Sidebar Direita -->
    <div class="space-y-6">
      <!-- Status Timeline -->
      <div class="glass-effect-advanced rounded-xl border border-cyan-500/20 overflow-hidden">
        <div class="bg-gradient-to-r from-cyan-900/30 to-blue-900/30 border-b border-cyan-500/20 px-6 py-4">
          <h3 class="text-xl font-semibold text-cyan-100 flex items-center">
            <i class="fas fa-tasks mr-3"></i>
            Status da Solicitação
          </h3>
        </div>
        <div class="p-6">
          <div class="space-y-6">
            <!-- Etapa 1: Solicitada -->
            <div class="flex items-start space-x-4">
              <div class="flex-shrink-0">
                <div class="w-10 h-10 rounded-full bg-gradient-to-r from-green-500 to-emerald-500 flex items-center justify-center shadow-lg shadow-green-500/25">
                  <i class="fas fa-check text-white text-sm"></i>
                </div>
              </div>
              <div class="flex-1">
                <div class="text-cyan-100 font-semibold">Solicitada</div>
                <div class="text-cyan-300 text-sm mt-1">Solicitação registrada no sistema</div>
                <div class="text-green-400 text-xs font-medium mt-1">Concluído</div>
              </div>
            </div>

            <!-- Etapa 2: Confeccionada -->
            <div class="flex items-start space-x-4">
              <div class="flex-shrink-0">
                <div class="w-10 h-10 rounded-full {% if placa.placa_confeccionada %}bg-gradient-to-r from-green-500 to-emerald-500{% else %}bg-cyan-500/20 border border-cyan-500/30{% endif %} flex items-center justify-center shadow-lg {% if placa.placa_confeccionada %}shadow-green-500/25{% else %}shadow-cyan-500/10{% endif %}">
                  {% if placa.placa_confeccionada %}
                  <i class="fas fa-check text-white text-sm"></i>
                  {% else %}
                  <i class="fas fa-hammer text-cyan-400 text-sm"></i>
                  {% endif %}
                </div>
              </div>
              <div class="flex-1">
                <div class="text-cyan-100 font-semibold">Confeccionada</div>
                <div class="text-cyan-300 text-sm mt-1">Placa produzida e pronta</div>
                {% if placa.placa_confeccionada %}
                <div class="text-green-400 text-xs font-medium mt-1">Concluído</div>
                {% else %}
                <div class="text-cyan-400 text-xs font-medium mt-1">Pendente</div>
                {% endif %}
              </div>
            </div>

            <!-- Etapa 3: A Caminho -->
            <div class="flex items-start space-x-4">
              <div class="flex-shrink-0">
                <div class="w-10 h-10 rounded-full {% if placa.placa_a_caminho %}bg-gradient-to-r from-green-500 to-emerald-500{% else %}bg-cyan-500/20 border border-cyan-500/30{% endif %} flex items-center justify-center shadow-lg {% if placa.placa_a_caminho %}shadow-green-500/25{% else %}shadow-cyan-500/10{% endif %}">
                  {% if placa.placa_a_caminho %}
                  <i class="fas fa-check text-white text-sm"></i>
                  {% else %}
                  <i class="fas fa-shipping-fast text-cyan-400 text-sm"></i>
                  {% endif %}
                </div>
              </div>
              <div class="flex-1">
                <div class="text-cyan-100 font-semibold">A Caminho</div>
                <div class="text-cyan-300 text-sm mt-1">Placa em transporte</div>
                {% if placa.placa_a_caminho %}
                <div class="text-green-400 text-xs font-medium mt-1">Concluído</div>
                {% else %}
                <div class="text-cyan-400 text-xs font-medium mt-1">Pendente</div>
                {% endif %}
              </div>
            </div>

            <!-- Etapa 4: Recebida -->
            <div class="flex items-start space-x-4">
              <div class="flex-shrink-0">
                <div class="w-10 h-10 rounded-full {% if placa.received %}bg-gradient-to-r from-green-500 to-emerald-500{% else %}bg-cyan-500/20 border border-cyan-500/30{% endif %} flex items-center justify-center shadow-lg {% if placa.received %}shadow-green-500/25{% else %}shadow-cyan-500/10{% endif %}">
                  {% if placa.received %}
                  <i class="fas fa-check text-white text-sm"></i>
                  {% else %}
                  <i class="fas fa-package text-cyan-400 text-sm"></i>
                  {% endif %}
                </div>
              </div>
              <div class="flex-1">
                <div class="text-cyan-100 font-semibold">Recebida</div>
                <div class="text-cyan-300 text-sm mt-1">Placa entregue e recebida</div>
                {% if placa.received %}
                <div class="text-green-400 text-xs font-medium mt-1">Concluído</div>
                {% else %}
                <div class="text-cyan-400 text-xs font-medium mt-1">Pendente</div>
                {% endif %}
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Confirmação de Recebimento -->
      <div class="glass-effect-advanced rounded-xl border border-cyan-500/20 overflow-hidden">
        <div class="bg-gradient-to-r from-cyan-900/30 to-blue-900/30 border-b border-cyan-500/20 px-6 py-4">
          <h3 class="text-xl font-semibold text-cyan-100 flex items-center">
            <i class="fas fa-check-circle mr-3"></i>
            Confirmação de Recebimento
          </h3>
        </div>
        <form method="POST" class="p-6">
          <div class="flex items-center space-x-3 mb-6">
            <label class="relative flex items-center cursor-pointer">
              {{ form.hidden_tag() }}
              <input
                type="checkbox"
                id="received"
                name="received"
                class="futuristic-checkbox hidden"
                {% if placa.received %}checked{% endif %}
              />
              <div class="w-6 h-6 border-2 border-cyan-400 rounded-md flex items-center justify-center transition-all duration-200 checkbox-indicator mr-3">
                <i class="fas fa-check text-cyan-400 text-xs opacity-0 transition-opacity duration-200"></i>
              </div>
              <span class="text-cyan-100 font-medium">Marcar como recebida</span>
            </label>
          </div>
          <button type="submit" class="futuristic-btn w-full group">
            <i class="fas fa-save mr-3 group-hover:scale-110 transition-transform duration-200"></i>
            Atualizar Status
          </button>
        </form>
      </div>
    </div>
  </div>
</div>
{% endblock %}