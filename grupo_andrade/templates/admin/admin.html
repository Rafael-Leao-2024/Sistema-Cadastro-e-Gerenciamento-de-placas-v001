{% extends "layout.html" %}
{% block title %}Area Admin{% endblock %}

{% block content %}
<div class="animate-fadeIn">
  <!-- Header -->
  <div class="flex justify-between items-center mb-8">
    <div class="flex items-center space-x-4">
      <div class="w-12 h-12 rounded-xl bg-gradient-to-r from-cyan-500 to-blue-500 flex items-center justify-center shadow-lg shadow-cyan-500/25">
        <i class="fas fa-users text-white text-lg"></i>
      </div>
      <div>
        <h2 class="text-3xl font-bold bg-gradient-to-r from-cyan-400 to-blue-400 bg-clip-text text-transparent">
          Gerenciar Administradores
        </h2>
        <p class="text-cyan-300/70 text-sm mt-1">Controle de permissões e acesso ao sistema</p>
      </div>
    </div>
    <a href="{{ url_for('placas.homepage') }}" class="futuristic-nav-btn group">
      <i class="fas fa-arrow-left mr-2 group-hover:-translate-x-1 transition-transform duration-200"></i>
      Voltar ao Início
    </a>
  </div>

  <!-- Card de Estatísticas -->
  <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
    <div class="glass-effect-advanced rounded-xl border border-cyan-500/20 p-6 text-center">
      <div class="w-16 h-16 mx-auto mb-3 rounded-full bg-cyan-500/20 flex items-center justify-center">
        <i class="fas fa-users text-cyan-400 text-xl"></i>
      </div>
      <p class="text-cyan-300 text-sm mb-1">Total de Usuários</p>
      <p class="text-2xl font-bold text-cyan-100">{{ usuarios|length }}</p>
    </div>
    
    <div class="glass-effect-advanced rounded-xl border border-cyan-500/20 p-6 text-center">
      <div class="w-16 h-16 mx-auto mb-3 rounded-full bg-green-500/20 flex items-center justify-center">
        <i class="fas fa-user-shield text-green-400 text-xl"></i>
      </div>
      <p class="text-cyan-300 text-sm mb-1">Administradores</p>
      <p class="text-2xl font-bold text-cyan-100">{{ usuarios|selectattr('is_admin')|list|length }}</p>
    </div>
    
    <div class="glass-effect-advanced rounded-xl border border-cyan-500/20 p-6 text-center">
      <div class="w-16 h-16 mx-auto mb-3 rounded-full bg-blue-500/20 flex items-center justify-center">
        <i class="fas fa-user text-blue-400 text-xl"></i>
      </div>
      <p class="text-cyan-300 text-sm mb-1">Usuários Comuns</p>
      <p class="text-2xl font-bold text-cyan-100">{{ usuarios|rejectattr('is_admin')|list|length }}</p>
    </div>
    
    <div class="glass-effect-advanced rounded-xl border border-cyan-500/20 p-6 text-center">
      <div class="w-16 h-16 mx-auto mb-3 rounded-full bg-purple-500/20 flex items-center justify-center">
        <i class="fas fa-chart-line text-purple-400 text-xl"></i>
      </div>
      <p class="text-cyan-300 text-sm mb-1">Atividade</p>
      <p class="text-2xl font-bold text-cyan-100">Online</p>
    </div>
  </div>

  <!-- Tabela de Usuários -->
  <div class="glass-effect-advanced rounded-xl border border-cyan-500/20 shadow-2xl shadow-cyan-500/10 overflow-hidden">
    <div class="bg-gradient-to-r from-cyan-900/30 to-blue-900/30 border-b border-cyan-500/20 px-6 py-4">
      <h3 class="text-xl font-semibold text-cyan-100 flex items-center">
        <i class="fas fa-list-ul mr-3"></i>
        Lista de Usuários do Sistema
      </h3>
    </div>
    
    <div class="overflow-x-auto">
      <table class="w-full">
        <thead>
          <tr class="border-b border-cyan-500/20">
            <th class="px-6 py-4 text-left text-cyan-300 font-semibold">ID</th>
            <th class="px-6 py-4 text-left text-cyan-300 font-semibold">Nome</th>
            <th class="px-6 py-4 text-left text-cyan-300 font-semibold">Email</th>
            <th class="px-6 py-4 text-left text-cyan-300 font-semibold">Data Cadastro</th>
            <th class="px-6 py-4 text-left text-cyan-300 font-semibold">Permissão</th>
            <th class="px-6 py-4 text-left text-cyan-300 font-semibold">Ação</th>
          </tr>
        </thead>
        <tbody>
          {% for usuario in usuarios %}
          <tr class="border-b border-cyan-500/10 hover:bg-cyan-500/5 transition-all duration-200 group">
            <td class="px-6 py-4">
              <span class="font-mono text-cyan-200 bg-cyan-500/10 px-2 py-1 rounded text-sm">{{ usuario.id }}</span>
            </td>
            <td class="px-6 py-4">
              <div class="flex items-center space-x-3">
                <div class="w-8 h-8 rounded-full bg-gradient-to-r from-cyan-500 to-blue-500 flex items-center justify-center">
                  <i class="fas fa-user text-white text-xs"></i>
                </div>
                <span class="text-cyan-100 font-medium">{{ usuario.username }}</span>
                {% if usuario.is_admin %}
                <span class="px-2 py-1 bg-gradient-to-r from-green-500 to-emerald-500 text-white text-xs rounded-full font-bold">ADMIN</span>
                {% endif %}
              </div>
            </td>
            <td class="px-6 py-4 text-cyan-200">{{ usuario.email }}</td>
            <td class="px-6 py-4">
              <span class="text-cyan-300 text-sm">{{ usuario.data_criacao.strftime('%d/%m/%Y') if usuario.data_criacao else 'N/A' }}</span>
            </td>
            <td class="px-6 py-4">
              {% if usuario.is_admin %}
              <div class="flex items-center space-x-2 text-green-400">
                <i class="fas fa-shield-check"></i>
                <span class="font-medium">Administrador</span>
              </div>
              {% else %}
              <div class="flex items-center space-x-2 text-cyan-300">
                <i class="fas fa-user"></i>
                <span>Usuário</span>
              </div>
              {% endif %}
            </td>
            <td class="px-6 py-4">
              <a
                href="{{ url_for('admin.permitir', id_usuario=usuario.id) }}"
                class="inline-flex items-center px-4 py-2 rounded-lg font-semibold transition-all duration-200 transform hover:scale-105 {% if usuario.is_admin %}bg-red-500/20 text-red-400 border border-red-500/30 hover:bg-red-500/30{% else %}bg-green-500/20 text-green-400 border border-green-500/30 hover:bg-green-500/30{% endif %}"
                title="{% if usuario.is_admin %}Remover permissão de admin{% else %}Tornar administrador{% endif %}"
              >
                {% if usuario.is_admin %}
                <i class="fas fa-lock-open mr-2"></i>
                Revogar
                {% else %}
                <i class="fas fa-lock mr-2"></i>
                Promover
                {% endif %}
              </a>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <!-- Footer da Tabela -->
    <div class="border-t border-cyan-500/20 px-6 py-4 bg-cyan-900/10">
      <div class="flex justify-between items-center text-sm">
        <span class="text-cyan-300/70">Total: {{ usuarios|length }} usuários</span>
        <div class="flex items-center space-x-4">
          <span class="text-cyan-300/70">
            <i class="fas fa-user-shield text-green-400 mr-1"></i>
            {{ usuarios|selectattr('is_admin')|list|length }} administradores
          </span>
          <span class="text-cyan-300/70">
            <i class="fas fa-user text-cyan-400 mr-1"></i>
            {{ usuarios|rejectattr('is_admin')|list|length }} usuários
          </span>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}